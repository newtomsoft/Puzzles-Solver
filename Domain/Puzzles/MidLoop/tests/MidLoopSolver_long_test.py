import unittest
from unittest import TestCase

from Domain.Board.Grid import Grid
from Domain.Board.IslandsGrid import IslandGrid
from Domain.Puzzles.MidLoop.MidLoopSolver import MidLoopSolver

_ = 0


class MidLoopSolverLongTests(TestCase):
    def test_solution_15x15_11pjk(self):
        """https://gridpuzzle.com/mid-loop/11pjk"""
        grid = Grid(
            [
                [_, _, _, 1, _, _, _, _, _, _, 1, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, 1, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, 1, _, 1, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, 1, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, 1],
                [_, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, 1, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _],
                [_, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, 1, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, 1, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, 1, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, 1],
                [_, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, 1, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _],
                [_, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, 1, _, _, _, _],
                [1, _, _, 1, _, _, _, _, _, _, _, 1, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _],
                [_, _, _, _, 1, _, _, _, _, _, 1, _, _, _, _, 1, _, _, _, 1, _, _, _, _, _, _, _, _, 1],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, 1, _, _, _],
            ]
        )

        expected_solution_str = (
            " ┌────────┐  ┌─────┐  ┌─────┐  ┌──┐  ┌─────┐ \n"
            " │  ·  ·  │  │  ┌──┘  │  ·  │  │  │  └──┐  │ \n"
            " │  ┌──┐  └──┘  └─────┘  ·  │  │  │  ·  │  │ \n"
            " └──┘  │  ┌──────────────┐  └──┘  └─────┘  │ \n"
            " ┌──┐  │  └───────────┐  │  ·  ┌───────────┘ \n"
            " │  └──┘  ┌──┐  ·  ·  │  │  ·  └───────────┐ \n"
            " └─────┐  │  │  ┌─────┘  └──┐  ┌────────┐  │ \n"
            " ┌──┐  └──┘  └──┘  ┌─────┐  │  │  ┌──┐  └──┘ \n"
            " │  └───────────┐  │  ·  └──┘  │  │  └─────┐ \n"
            " └───────────┐  │  │  ·  ┌─────┘  │  ┌─────┘ \n"
            " ┌────────┐  │  │  │  ┌──┘  ┌─────┘  └─────┐ \n"
            " │  ·  ·  │  │  │  │  │  ┌──┘  ┌──┐  ┌─────┘ \n"
            " │  ┌──┐  └──┘  └──┘  │  │  ·  │  │  └─────┐ \n"
            " │  │  │  ·  ┌─────┐  └──┘  ┌──┘  │  ·  ·  │ \n"
            " └──┘  └─────┘  ·  └────────┘  ·  └────────┘ "
        )

        game_solver = MidLoopSolver(grid)
        solution = game_solver.get_solution()
        self.assertEqual(expected_solution_str, str(solution))
        other_solution = game_solver.get_other_solution()
        self.assertEqual(IslandGrid.empty(), other_solution)

    def test_solution_15x15_0gmw8(self):
        """https://gridpuzzle.com/mid-loop/0gmw8"""
        grid = Grid(
            [
                [_, _, _, 1, _, _, _, _, _, 1, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, 1, _, _],
                [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, 1, _, _, _, _, _, 1, _, _, _, _, _, _, _, 1, _, _, _, _, 1, _, _, 1, _, _, _, _],
                [_, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _],
                [1, _, _, 1, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, 1, _, _, _, _, 1, _, _],
                [_, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, 1, _, _, _, _, _, 1, _, _, _, _, _, 1, _, _, _, 1, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, 1, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _],
                [_, _, 1, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, 1, _, _, _, 1, _, _, _, _, _, 1, _, _],
                [_, _, _, _, 1, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, 1, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
                [_, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _],
                [_, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, 1, _, _, _, _, _, _, _, 1, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, 1, _, _],
                [1, _, 1, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, 1, _, _, _, _],
                [_, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, 1, _, _, _, _, _, _, 1, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, 1, _, _, _, _, _, 1, _, 1, _, _, _, _, _, _, _, _, _, _, _, 1],
                [_, _, 1, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, 1, _, 1, _, _],
                [_, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, 1, _, _, _, _, _, _],
            ]
        )

        expected_solution_str = (
            " ┌────────┐  ┌──┐  ┌──────────────┐  ┌─────┐ \n"
            " └─────┐  │  │  └──┘  ┌─────┐  ┌──┘  │  ·  │ \n"
            " ┌─────┘  │  └──┐  ┌──┘  ·  │  │  ┌──┘  ·  │ \n"
            " │  ┌──┐  └─────┘  └─────┐  │  └──┘  ┌─────┘ \n"
            " └──┘  │  ·  ┌─────┐  ·  │  └─────┐  └─────┐ \n"
            " ┌─────┘  ┌──┘  ·  └─────┘  ┌──┐  └─────┐  │ \n"
            " └─────┐  │  ·  ┌────────┐  │  └─────┐  └──┘ \n"
            " ·  ·  │  │  ┌──┘  ·  ·  │  └─────┐  └─────┐ \n"
            " ·  ·  │  └──┘  ┌────────┘  ┌─────┘  ·  ·  │ \n"
            " ┌──┐  └──┐  ┌──┘  ┌─────┐  │  ┌───────────┘ \n"
            " │  └─────┘  └──┐  └──┐  │  │  └───────────┐ \n"
            " │  ┌────────┐  └─────┘  └──┘  ┌──┐  ┌─────┘ \n"
            " │  └─────┐  └─────┐  ┌──┐  ┌──┘  │  └─────┐ \n"
            " │  ┌──┐  └─────┐  │  │  │  │  ┌──┘  ┌──┐  │ \n"
            " └──┘  └────────┘  └──┘  └──┘  └─────┘  └──┘ "
        )

        game_solver = MidLoopSolver(grid)
        solution = game_solver.get_solution()
        self.assertEqual(expected_solution_str, str(solution))
        other_solution = game_solver.get_other_solution()
        self.assertEqual(IslandGrid.empty(), other_solution)

    @unittest.skip("This test is skipped because the solver does not support this puzzle.")
    def test_solution_12x12_0dp48(self):
        """https://gridpuzzle.com/mid-loop/0dp48"""
        grid = Grid(
            [
                [_, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [1, _, _, _, _, _, _, _, _, _, _, 1, _, _, 1, _, 1, _, 1, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, 1],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, 1, _, _, _, _, _, _, 1, _, _, 1, _, _, _, _, _, _, _, _, 1, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _],
                [_, _, _, _, 1, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, 1, _, _, _],
                [_, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _],
                [_, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _],
                [_, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _],
                [_, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, 1, _, _, _, _],
                [_, _, _, _, _, 1, _, _, _, _, _, _, _, _, 1, _, _, 1, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1],
                [_, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _],
            ]
        )

        expected_solution_str = (
            " ┌─────┐  ┌─────┐    \n"
            " └──┐  │  │  ·  └──┐ \n"
            "    │  └──┘  ┌──┐  │ \n"
            "    │  ·  ┌──┘  │  │ \n"
            " ┌──┘  ·  │     └──┘ \n"
            " │  ┌──┐  └────────┐ \n"
            " └──┘  └───────────┘ "
        )

        game_solver = MidLoopSolver(grid)
        solution = game_solver.get_solution()
        self.assertEqual(expected_solution_str, str(solution))
        other_solution = game_solver.get_other_solution()
        self.assertEqual(IslandGrid.empty(), other_solution)

    @unittest.skip("This test is skipped because the solver does not support this puzzle.")
    def test_solution_12x12_4mg5g(self):
        """https://gridpuzzle.com/mid-loop/4mg5g"""
        grid = Grid(
            [
                [_, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, 1, _, _],
                [_, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [1, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, 1],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, 1, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, 1, _, _, _, _],
                [_, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, 1, _, _, 1, _, _, _, 1, _, _, _, _, _, _, 1, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, 1, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, _, _, 1, _, _],
                [_, _, 1, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, 1, _],
                [_, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, 1, _, 1, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _],
                [1, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _, _],
                [_, _, _, _, _, _, _, _, _, _, 1, _, _, _, _, _, _, _, _, 1, _, _, _],
            ]
        )
        game_solver = MidLoopSolver(grid)
        solution = game_solver.get_solution()
        self.assertNotEqual(IslandGrid.empty(), solution)
        other_solution = game_solver.get_other_solution()
        self.assertEqual(IslandGrid.empty(), other_solution)


if __name__ == "__main__":
    unittest.main()

import unittest

from Domain.Board.Grid import Grid
from Domain.Puzzles.Detour.DetourSolver import DetourSolver


class DetourSolverLongTests(unittest.TestCase):

    def test_12x12_evil_6yqpn(self):
        """https://gridpuzzle.com/detour/6yqpn"""
        regions_grid = Grid([
            [1, 2, 2, 3, 3, 4, 5, 5, 5, 6, 7, 7],
            [1, 8, 9, 10, 10, 4, 11, 11, 5, 6, 7, 12],
            [1, 8, 9, 13, 14, 14, 14, 15, 16, 16, 17, 12],
            [18, 19, 9, 13, 20, 20, 14, 15, 15, 17, 17, 12],
            [18, 19, 19, 21, 21, 20, 20, 15, 22, 22, 22, 12],
            [23, 19, 21, 21, 24, 25, 26, 26, 22, 27, 27, 27],
            [23, 28, 28, 28, 24, 24, 26, 26, 29, 30, 31, 31],
            [32, 32, 33, 34, 34, 24, 35, 35, 35, 30, 36, 31],
            [37, 33, 33, 33, 34, 34, 35, 38, 38, 30, 36, 39],
            [37, 37, 40, 41, 41, 42, 42, 38, 43, 30, 44, 39],
            [37, 45, 40, 46, 42, 42, 47, 47, 43, 44, 44, 48],
            [45, 45, 45, 46, 49, 49, 49, 50, 50, 50, 48, 48]
        ])
        clues_grid = Grid([
            [1, 1, _, _, _, _, _, _, _, _, 3, _],
            [_, 2, _, _, _, _, 0, _, _, _, _, 2],
            [_, _, _, 1, 4, _, _, _, 1, _, 2, _],
            [_, 2, _, _, 2, _, _, _, _, _, _, _],
            [_, _, _, 2, _, _, _, _, 2, _, _, _],
            [_, _, _, _, 2, _, 2, _, _, 2, _, _],
            [_, 1, _, _, _, _, _, _, _, 4, _, _],
            [_, _, 4, 2, _, _, 4, _, _, _, _, _],
            [3, _, _, _, _, _, _, 2, _, _, _, _],
            [_, _, _, 2, _, 3, _, _, 0, _, _, _],
            [_, 3, _, 1, _, _, _, _, _, _, _, 1],
            [_, _, _, _, _, _, _, 0, _, _, _, _]
        ])

        expected_solution_str = (
            ' ┌─────┐  ┌─────┐  ┌──┐  ┌──┐  ┌──┐ \n'
            ' │  ┌──┘  └──┐  │  │  │  │  └──┘  │ \n'
            ' │  └────────┘  └──┘  │  │  ┌──┐  │ \n'
            ' └─────┐  ┌──┐  ┌──┐  │  │  │  └──┘ \n'
            ' ┌──┐  └──┘  │  │  │  │  │  │  ┌──┐ \n'
            ' │  │  ┌─────┘  │  │  └──┘  └──┘  │ \n'
            ' │  │  └─────┐  │  │  ┌─────┐  ┌──┘ \n'
            ' │  │  ┌──┐  │  │  └──┘  ┌──┘  └──┐ \n'
            ' │  └──┘  └──┘  │  ┌─────┘  ┌─────┘ \n'
            ' └──┐  ┌──┐  ┌──┘  │  ┌─────┘  ┌──┐ \n'
            ' ┌──┘  │  │  └──┐  │  └────────┘  │ \n'
            ' └─────┘  └─────┘  └──────────────┘ '
        )

        game_solver = DetourSolver(clues_grid, regions_grid)
        solution = game_solver.get_solution()
        self.assertEqual(expected_solution_str, str(solution))
        other_solution = game_solver.get_other_solution()
        self.assertEqual(Grid.empty(), other_solution)

import unittest
from unittest import TestCase

from Domain.Board.Grid import Grid
from Domain.Puzzles.Masyu.MasyuSolver import MasyuSolver

_ = ' '
W = 'w'
B = 'b'


class MasyuSolverLongTests(TestCase):
    def test_solution_20x20(self):
        grid = Grid([
            [_, W, _, W, _, _, B, W, W, _, _, _, _, _, _, W, _, _, _, _],
            [_, _, _, W, _, _, _, _, W, _, W, _, _, B, W, _, _, _, _, W],
            [W, _, W, _, _, _, _, W, _, _, _, W, _, _, _, W, W, W, W, _],
            [_, W, _, W, B, W, _, _, _, _, _, W, _, _, W, _, _, W, _, _],
            [_, _, _, _, _, _, W, W, W, W, _, W, _, _, _, W, _, _, W, _],
            [_, _, _, B, W, _, _, _, _, _, _, _, _, W, _, _, B, _, B, _],
            [W, _, _, _, B, W, _, _, _, B, _, _, _, _, W, _, W, _, _, _],
            [_, _, _, _, W, _, _, W, _, _, W, W, _, _, _, _, W, W, W, _],
            [W, W, B, _, W, _, B, W, W, _, B, W, W, _, W, _, _, _, _, _],
            [_, _, _, _, _, _, W, _, _, _, _, _, W, _, _, W, _, _, _, _],
            [_, _, _, _, _, _, _, B, _, B, _, _, W, B, W, B, _, W, _, _],
            [_, W, W, B, _, W, _, _, _, _, _, _, _, W, _, _, _, W, W, _],
            [_, _, _, W, B, _, _, _, _, _, _, W, W, B, W, _, W, _, _, _],
            [_, _, _, _, W, B, _, W, _, W, W, _, _, _, _, _, _, W, _, _],
            [W, B, W, W, _, _, _, _, _, _, W, B, W, _, W, _, W, _, W, _],
            [_, W, _, _, _, W, _, _, _, W, B, W, _, _, B, W, _, B, _, _],
            [W, _, W, _, _, B, W, _, _, _, _, W, _, _, _, _, _, _, W, _],
            [B, _, _, W, B, _, W, _, W, _, _, B, _, _, _, _, W, B, _, _],
            [_, _, _, _, W, _, _, W, B, W, B, _, _, _, B, _, _, _, _, W],
            [_, _, W, _, W, _, _, B, W, _, W, _, _, _, _, B, _, _, W, B]
        ])
        game_solver = MasyuSolver(grid)
        solution = game_solver.get_solution()
        expected_solution_string = (
            ' ┌───────────┐  ·  ┌────────┐  ┌──┐  ·  ·  ┌──────────────┐ \n'
            ' │  ┌────────┘  ·  │  ┌─────┘  │  └─────┐  │  ┌──┐  ┌──┐  │ \n'
            ' │  └───────────┐  │  │  ·  ·  └─────┐  │  │  │  │  │  │  │ \n'
            ' └───────────┐  │  │  │  ┌──┐  ┌─────┘  │  │  │  │  │  │  │ \n'
            ' ·  ·  ·  ·  │  │  │  │  │  │  └─────┐  └──┘  │  └──┘  │  │ \n'
            ' ┌────────┐  │  └──┘  └──┘  │  ·  ·  └────────┘  ┌─────┘  │ \n'
            ' │  ┌──┐  │  └───────────┐  └────────┐  ┌─────┐  │  ┌──┐  │ \n'
            ' │  │  │  └──────────────┘  ┌────────┘  └──┐  │  │  │  │  │ \n'
            ' │  │  └────────┐  ┌────────┘  ┌────────┐  │  │  └──┘  │  │ \n'
            ' └──┘  ·  ┌─────┘  │  ·  ·  ·  │  ┌─────┘  │  │  ·  ·  │  │ \n'
            ' ·  ·  ·  │  ┌──┐  │  ┌─────┐  │  └─────┐  │  └────────┘  │ \n'
            ' ┌────────┘  │  │  │  │  ·  │  │  ┌──┐  │  └──┐  ┌────────┘ \n'
            ' └──┐  ┌─────┘  └──┘  │  ·  └──┘  │  │  └─────┘  │  ┌─────┐ \n'
            ' ┌──┘  └────────┐  ·  │  ┌────────┘  │  ┌──┐  ┌──┘  │  ┌──┘ \n'
            ' │  ┌────────┐  │  ┌──┘  └────────┐  │  │  │  └─────┘  │  · \n'
            ' │  │  ·  ·  │  │  └───────────┐  │  └──┘  └────────┐  │  · \n'
            ' │  └─────┐  │  └────────┐  ·  │  │  ·  ┌──┐  ·  ·  │  │  · \n'
            ' └─────┐  │  └────────┐  │  ·  │  └─────┘  │  ┌─────┘  └──┐ \n'
            ' ·  ┌──┘  └─────┐  ·  │  └─────┘  ┌────────┘  │  ·  ·  ·  │ \n'
            ' ·  └───────────┘  ·  └───────────┘  ·  ·  ·  └───────────┘ '
        )
        self.assertEqual(expected_solution_string, str(solution))
        other_solution = game_solver.get_other_solution()
        self.assertEqual(Grid.empty(), other_solution)


if __name__ == '__main__':
    unittest.main()

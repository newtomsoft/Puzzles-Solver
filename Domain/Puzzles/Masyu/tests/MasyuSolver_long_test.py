import unittest
from unittest import TestCase

from Domain.Board.Grid import Grid
from Domain.Puzzles.Masyu.MasyuSolver import MasyuSolver


class MasyuSolverLongTests(TestCase):

    def test_solution_20x20(self):
        grid = Grid([
            [' ', 'w', ' ', 'w', ' ', ' ', 'b', 'w', 'w', ' ', ' ', ' ', ' ', ' ', ' ', 'w', ' ', ' ', ' ', ' '],
            [' ', ' ', ' ', 'w', ' ', ' ', ' ', ' ', 'w', ' ', 'w', ' ', ' ', 'b', 'w', ' ', ' ', ' ', ' ', 'w'],
            ['w', ' ', 'w', ' ', ' ', ' ', ' ', 'w', ' ', ' ', ' ', 'w', ' ', ' ', ' ', 'w', 'w', 'w', 'w', ' '],
            [' ', 'w', ' ', 'w', 'b', 'w', ' ', ' ', ' ', ' ', ' ', 'w', ' ', ' ', 'w', ' ', ' ', 'w', ' ', ' '],
            [' ', ' ', ' ', ' ', ' ', ' ', 'w', 'w', 'w', 'w', ' ', 'w', ' ', ' ', ' ', 'w', ' ', ' ', 'w', ' '],
            [' ', ' ', ' ', 'b', 'w', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 'w', ' ', ' ', 'b', ' ', 'b', ' '],
            ['w', ' ', ' ', ' ', 'b', 'w', ' ', ' ', ' ', 'b', ' ', ' ', ' ', ' ', 'w', ' ', 'w', ' ', ' ', ' '],
            [' ', ' ', ' ', ' ', 'w', ' ', ' ', 'w', ' ', ' ', 'w', 'w', ' ', ' ', ' ', ' ', 'w', 'w', 'w', ' '],
            ['w', 'w', 'b', ' ', 'w', ' ', 'b', 'w', 'w', ' ', 'b', 'w', 'w', ' ', 'w', ' ', ' ', ' ', ' ', ' '],
            [' ', ' ', ' ', ' ', ' ', ' ', 'w', ' ', ' ', ' ', ' ', ' ', 'w', ' ', ' ', 'w', ' ', ' ', ' ', ' '],
            [' ', ' ', ' ', ' ', ' ', ' ', ' ', 'b', ' ', 'b', ' ', ' ', 'w', 'b', 'w', 'b', ' ', 'w', ' ', ' '],
            [' ', 'w', 'w', 'b', ' ', 'w', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 'w', ' ', ' ', ' ', 'w', 'w', ' '],
            [' ', ' ', ' ', 'w', 'b', ' ', ' ', ' ', ' ', ' ', ' ', 'w', 'w', 'b', 'w', ' ', 'w', ' ', ' ', ' '],
            [' ', ' ', ' ', ' ', 'w', 'b', ' ', 'w', ' ', 'w', 'w', ' ', ' ', ' ', ' ', ' ', ' ', 'w', ' ', ' '],
            ['w', 'b', 'w', 'w', ' ', ' ', ' ', ' ', ' ', ' ', 'w', 'b', 'w', ' ', 'w', ' ', 'w', ' ', 'w', ' '],
            [' ', 'w', ' ', ' ', ' ', 'w', ' ', ' ', ' ', 'w', 'b', 'w', ' ', ' ', 'b', 'w', ' ', 'b', ' ', ' '],
            ['w', ' ', 'w', ' ', ' ', 'b', 'w', ' ', ' ', ' ', ' ', 'w', ' ', ' ', ' ', ' ', ' ', ' ', 'w', ' '],
            ['b', ' ', ' ', 'w', 'b', ' ', 'w', ' ', 'w', ' ', ' ', 'b', ' ', ' ', ' ', ' ', 'w', 'b', ' ', ' '],
            [' ', ' ', ' ', ' ', 'w', ' ', ' ', 'w', 'b', 'w', 'b', ' ', ' ', ' ', 'b', ' ', ' ', ' ', ' ', 'w'],
            [' ', ' ', 'w', ' ', 'w', ' ', ' ', 'b', 'w', ' ', 'w', ' ', ' ', ' ', ' ', 'b', ' ', ' ', 'w', 'b']
        ])
        game_solver = MasyuSolver(grid)
        solution = game_solver.get_solution()
        expected_solution_string = (
            ' ┌───────────┐  ·  ┌────────┐  ┌──┐  ·  ·  ┌──────────────┐ \n'
            ' │  ┌────────┘  ·  │  ┌─────┘  │  └─────┐  │  ┌──┐  ┌──┐  │ \n'
            ' │  └───────────┐  │  │  ·  ·  └─────┐  │  │  │  │  │  │  │ \n'
            ' └───────────┐  │  │  │  ┌──┐  ┌─────┘  │  │  │  │  │  │  │ \n'
            ' ·  ·  ·  ·  │  │  │  │  │  │  └─────┐  └──┘  │  └──┘  │  │ \n'
            ' ┌────────┐  │  └──┘  └──┘  │  ·  ·  └────────┘  ┌─────┘  │ \n'
            ' │  ┌──┐  │  └───────────┐  └────────┐  ┌─────┐  │  ┌──┐  │ \n'
            ' │  │  │  └──────────────┘  ┌────────┘  └──┐  │  │  │  │  │ \n'
            ' │  │  └────────┐  ┌────────┘  ┌────────┐  │  │  └──┘  │  │ \n'
            ' └──┘  ·  ┌─────┘  │  ·  ·  ·  │  ┌─────┘  │  │  ·  ·  │  │ \n'
            ' ·  ·  ·  │  ┌──┐  │  ┌─────┐  │  └─────┐  │  └────────┘  │ \n'
            ' ┌────────┘  │  │  │  │  ·  │  │  ┌──┐  │  └──┐  ┌────────┘ \n'
            ' └──┐  ┌─────┘  └──┘  │  ·  └──┘  │  │  └─────┘  │  ┌─────┐ \n'
            ' ┌──┘  └────────┐  ·  │  ┌────────┘  │  ┌──┐  ┌──┘  │  ┌──┘ \n'
            ' │  ┌────────┐  │  ┌──┘  └────────┐  │  │  │  └─────┘  │  · \n'
            ' │  │  ·  ·  │  │  └───────────┐  │  └──┘  └────────┐  │  · \n'
            ' │  └─────┐  │  └────────┐  ·  │  │  ·  ┌──┐  ·  ·  │  │  · \n'
            ' └─────┐  │  └────────┐  │  ·  │  └─────┘  │  ┌─────┘  └──┐ \n'
            ' ·  ┌──┘  └─────┐  ·  │  └─────┘  ┌────────┘  │  ·  ·  ·  │ \n'
            ' ·  └───────────┘  ·  └───────────┘  ·  ·  ·  └───────────┘ '
        )
        self.assertEqual(expected_solution_string, str(solution))
        other_solution = game_solver.get_other_solution()
        self.assertEqual(Grid.empty(), other_solution)


if __name__ == '__main__':
    unittest.main()
